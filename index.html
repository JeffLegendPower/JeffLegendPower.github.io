
<!DOCTYPE html>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@100..900&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <title>Templates</title>
    </head>
    <body>
        <div id="flex-stack">
            <div id="title-outer">
                <div id="title-inner">
                    <h2>Templates</h2>
                </div>
            </div>
            <div id="posts-outer">
                <div id="posts-inner">

<div class="post"><div class="content">
    <div class="post-title">
        <a class="post-title-name">dsu</a>
    </div>
    <pre class="code-color">vector&lt;<span class=g>int</span>&gt; <span class=b>root</span>(MAXN, <span class=y>-</span><span class=y>1</span>);<br>
<span class=r>// find root of node i</span>
<span class=g>int</span> <span class=b>find</span>(<span class=g>int</span> i){
    <span class=y>if</span>(root<span class=b>[</span>i<span class=b>]</span> &lt; <span class=y>0</span>) <span class=y>return</span> i;
    <span class=y>return</span> root<span class=b>[</span>i<span class=b>]</span> = <span class=b>find</span>(root<span class=b>[</span>i<span class=b>]</span>);
}<br>
<span class=r>// merge nodes a, b</span>
<span class=g>void</span> <span class=b>merge</span>(<span class=g>int</span> a, <span class=g>int</span> b){
    <span class=y>if</span>((a = <span class=b>find</span>(a)) == (b = <span class=b>find</span>(b))) <span class=y>return</span>;
    <span class=y>if</span>(root<span class=b>[</span>a<span class=b>]</span> &lt; root<span class=b>[</span>b<span class=b>]</span>) root<span class=b>[</span>a<span class=b>]</span> += root<span class=b>[</span>b<span class=b>]</span>, root<span class=b>[</span>b<span class=b>]</span> = a;
    <span class=y>else</span> root<span class=b>[</span>b<span class=b>]</span> += root<span class=b>[</span>a<span class=b>]</span>, root<span class=b>[</span>a<span class=b>]</span> = b;
}</pre>
</div></div>
<div class="post-spacer"></div>

<div class="post"><div class="content">
    <div class="post-title">
        <a class="post-title-name">binlift</a>
    </div>
    <pre class="code-color"><span class=g>int</span> jmp<span class=b>[</span><span class=y>20</span><span class=b>]</span><span class=b>[</span>MAXN<span class=b>]</span>, dep<span class=b>[</span>MAXN<span class=b>]</span>;<br>
<span class=r>// add child to parent</span>
<span class=g>void</span> <span class=b>addchild</span>(<span class=g>int</span> parent, <span class=g>int</span> child){
    jmp<span class=b>[</span><span class=y>0</span><span class=b>]</span><span class=b>[</span>child<span class=b>]</span> = parent;
    dep<span class=b>[</span>child<span class=b>]</span> = dep<span class=b>[</span>parent<span class=b>]</span>+<span class=y>1</span>;
}<br>
<span class=r>// prepare jumps</span>
<span class=g>void</span> <span class=b>build</span>(){
    <span class=y>for</span>(<span class=g>int</span> i=<span class=y>0</span>; i&lt;<span class=y>20</span>; ++i)
        <span class=y>for</span>(<span class=g>int</span> j=<span class=y>0</span>; j&lt;MAXN; ++j)
            jmp<span class=b>[</span>i<span class=b>]</span><span class=b>[</span>j<span class=b>]</span> = jmp<span class=b>[</span>i<span class=y>-</span><span class=y>1</span><span class=b>]</span><span class=b>[</span>jmp<span class=b>[</span>i<span class=y>-</span><span class=y>1</span><span class=b>]</span><span class=b>[</span>j<span class=b>]</span><span class=b>]</span>;
}<br>
<span class=r>// kth ancestor of i</span>
<span class=g>int</span> <span class=b>kth</span>(<span class=g>int</span> i, <span class=g>int</span> k){
    <span class=y>for</span>(<span class=g>int</span> x=<span class=y>19</span>; x&gt;=<span class=y>0</span>; --x)
        <span class=y>if</span>(k &amp; (<span class=y>1</span>&lt;&lt;x)) i = jmp<span class=b>[</span>x<span class=b>]</span><span class=b>[</span>i<span class=b>]</span>;
    <span class=y>return</span> i;
}<br>
<span class=r>// LCA of a, b</span>
<span class=g>int</span> <span class=b>lca</span>(<span class=g>int</span> a, <span class=g>int</span> b){
    <span class=y>if</span>(dep<span class=b>[</span>a<span class=b>]</span> &lt; dep<span class=b>[</span>b<span class=b>]</span>) std::<span class=b>swap</span>(a, b);
    a = <span class=b>kth</span>(a, dep<span class=b>[</span>a<span class=b>]</span> - dep<span class=b>[</span>b<span class=b>]</span>);
    <span class=y>if</span>(a == b) <span class=y>return</span> a;
    <span class=y>for</span>(<span class=g>int</span> x=<span class=y>19</span>; x&gt;=<span class=y>0</span>; --x)
        <span class=y>if</span>(jmp<span class=b>[</span>x<span class=b>]</span><span class=b>[</span>a<span class=b>]</span> != jmp<span class=b>[</span>x<span class=b>]</span><span class=b>[</span>b<span class=b>]</span>)
            a = jmp<span class=b>[</span>x<span class=b>]</span><span class=b>[</span>a<span class=b>]</span>, b = jmp<span class=b>[</span>x<span class=b>]</span><span class=b>[</span>b<span class=b>]</span>;
    <span class=y>return</span> jmp<span class=b>[</span><span class=y>0</span><span class=b>]</span><span class=b>[</span>a<span class=b>]</span>;
}</pre>
</div></div>
                </div>
            </div>
        </div>
    </body>
</html>